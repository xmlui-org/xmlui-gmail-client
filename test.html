<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Two-Pane Demo – Mixed Message Heights</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body { font-family: system-ui, sans-serif; }

    .app {
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      flex: 0 0 auto;
      padding: 10px 14px;
      background: #fff;
      border-bottom: 1px solid #ddd;
      font-weight: 600;
    }

    .main {
      flex: 1 1 auto;
      min-height: 0;           /* allow children to scroll */
      display: flex;
    }

    .pane-left {
      width: 280px;
      border-right: 1px solid #ddd;
      background: #fff;
      overflow-y: auto;         /* own scroll */
    }

    .pane-right {
      flex: 1;
      background: #fff;
      overflow-y: auto;         /* own scroll */
      padding: 12px 16px;
    }

    .message-list {
      display: flex;
      flex-direction: column;
    }

    .message-card {
      padding: 10px 12px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
    }

    .message-card:hover { background: #eef4ff; }
    .message-card.selected { background: #c7ddff; }

    .card-subject { font-weight: 600; margin-bottom: 2px; }
    .card-from { font-size: 13px; color: #666; margin-bottom: 4px; }
    .card-snippet {
      font-size: 12px;
      color: #444;
      line-height: 1.3;
      max-height: 2.6em;
      overflow: hidden;
    }

    .message-header {
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 18px;
    }

    .message-meta {
      color: #555;
      font-size: 13px;
      margin-bottom: 12px;
    }

    .message-body {
      white-space: pre-wrap;
      font-size: 14px;
      line-height: 1.5;
    }

    .hint {
      margin-top: 16px;
      font-size: 12px;
      color: #777;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>Two-Pane Demo – Mixed Message Heights</header>
    <div class="main">
      <div class="pane-left">
        <div id="messageList" class="message-list"></div>
      </div>
      <div class="pane-right" id="rightPane">
        <div id="messageView">
          <div class="message-header">Select a message</div>
          <div class="message-body">
            Some messages are short (no scrollbar here), some are long (scrollbar appears).
            Clicking a card always scrolls this pane to the top of that message and keeps
            the card visible on the left.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const messageListEl = document.getElementById("messageList");
    const rightPane = document.getElementById("rightPane");
    const messageViewEl = document.getElementById("messageView");

    const messages = Array.from({ length: 25 }).map((_, i) => {
      const isLong = i % 3 !== 0; // ~2/3 long, 1/3 short
      return {
        id: String(i),
        subject: `Message #${i} (${isLong ? "long" : "short"})`,
        from: `sender${i}@example.com`,
        snippet: `Preview for message #${i} – this one is ${isLong ? "long" : "short"}.`,
        body: makeBody(i, isLong),
      };
    });

    function makeBody(i, isLong) {
      let text =
        `Subject: Message #${i}\n` +
        `From: sender${i}@example.com\n` +
        `Type: ${isLong ? "LONG (scrollbar expected)" : "SHORT (no scrollbar)"}\n\n`;

      const paragraphCount = isLong ? 45 : 4;

      for (let p = 0; p < paragraphCount; p++) {
        text += `Paragraph ${p + 1} of message #${i}. ` +
          `Lorem ipsum dolor sit amet, consectetur adipiscing elit. ` +
          `Curabitur volutpat nisl a faucibus tempus.\n\n`;
      }
      return text;
    }

    function renderList() {
      messageListEl.innerHTML = "";
      messages.forEach(msg => {
        const card = document.createElement("div");
        card.className = "message-card";
        card.dataset.id = msg.id;
        card.innerHTML = `
          <div class="card-subject">${msg.subject}</div>
          <div class="card-from">${msg.from}</div>
          <div class="card-snippet">${msg.snippet}</div>
        `;
        card.addEventListener("click", () => selectMessage(msg.id));
        messageListEl.appendChild(card);
      });
    }

    function selectMessage(id) {
      document.querySelectorAll(".message-card").forEach(c =>
        c.classList.toggle("selected", c.dataset.id === id)
      );

      const msg = messages.find(m => m.id === id);
      if (!msg) return;

      messageViewEl.innerHTML = `
        <div class="message-header">${msg.subject}</div>
        <div class="message-meta">From: ${msg.from}</div>
        <div class="message-body">${msg.body.replace(/\n/g, "<br>")}</div>
        <div class="hint">
          Scroll down if this is a long message. The selected card stays visible on the left.
        </div>
      `;

      // Scroll RIGHT pane to top (harmless if message is short)
      rightPane.scrollTo({ top: 0, behavior: "smooth" });

      // Ensure card is visible in the left pane
      const cardEl = document.querySelector(`.message-card[data-id="${id}"]`);
      if (cardEl) {
        cardEl.scrollIntoView({
          behavior: "smooth",
          block: "nearest",
          inline: "nearest",
        });
      }
    }

    renderList();
  </script>
</body>
</html>
