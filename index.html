<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://docs.xmlui.org/resources/files/for-download/xmlui/xmlui-standalone.umd.js"></script>
    <script type="module">
      import parseGmailMessage from "https://cdn.jsdelivr.net/npm/gmail-api-parse-message@2.1.2/+esm";
      import he from "https://cdn.jsdelivr.net/npm/he@1.2.0/+esm";
      import { parseOneAddress, parseFrom } from "https://cdn.jsdelivr.net/npm/email-addresses@5.0.0/+esm";
      import DOMPurify from "https://cdn.jsdelivr.net/npm/dompurify@3.1.5/+esm";

      window.parseGmailMessage = parseGmailMessage;
      window.he = he;
      window.emailAddresses = { parseOneAddress, parseFrom };
      window.DOMPurify = DOMPurify;

      window.getIframeHeight = function() {
        return window.innerHeight - 200;
      };

      window.wrapEmailHtml = function(htmlContent) {
        return `<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<base target="_blank">
<style>
body { margin: 0; padding: 16px; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; font-size: 14px; line-height: 1.5; word-wrap: break-word; overflow-wrap: break-word; overflow: hidden; }
img { max-width: 100% !important; height: auto !important; }
table { max-width: 100% !important; width: auto !important; }
td, th { word-wrap: break-word; overflow-wrap: break-word; }
.gmail_quote { margin: 0; padding: 0; }
</style>
</head>
<body>
${htmlContent}
</body>
</html>`;
      };
    </script>
    <script src="xmlui/xmlui-hello-auth.js"></script>
    <script>
      window.config = {};
      fetch("config.json")
        .then((r) => (r.ok ? r.json() : {}))
        .then((c) => Object.assign(window.config, c));
    </script>
  </head>

  <body></body>
</html>
